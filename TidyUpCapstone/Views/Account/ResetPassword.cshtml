@model TidyUpCapstone.Models.DTOs.Authentication.ResetPasswordDto
@{
    ViewData["Title"] = "Reset Password";
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.HideNavigation = true;
}

@section Styles {
    <link rel="stylesheet" href="~/css/account.css" />
}

<div class="reset-container d-flex align-items-center justify-content-center min-vh-100">
    <div class="card reset-card shadow-lg border-0 rounded-4">
        <div class="card-body p-5 animate__animated animate__fadeInUp">

            <!-- Icon & Header -->
            <div class="text-center mb-4">
                <i class="fas fa-shield-alt text-success mb-3" style="font-size: 3.5rem;"></i>
                <h1 class="h3 fw-bold mb-2">Reset Your Password</h1>
                <p class="text-muted small">Enter a strong new password to secure your account.</p>
            </div>

            <!-- Form -->
            <form asp-action="ResetPassword" method="post" novalidate>
                @Html.AntiForgeryToken()
                <div asp-validation-summary="All" class="alert alert-danger d-none mb-3"></div>

                <!-- Hidden fields -->
                <input asp-for="Token" type="hidden" />
                <input asp-for="Email" type="hidden" />

                <!-- Email -->
                <div class="mb-3">
                    <label class="form-label fw-semibold">Email Address</label>
                    <input type="email" class="form-control bg-light" value="@Model.Email" readonly />
                </div>

                <!-- New Password -->
                <div class="mb-3">
                    <label asp-for="Password" class="form-label fw-semibold">New Password</label>
                    <div class="input-group">
                        <input asp-for="Password" type="password" class="form-control form-control-lg" placeholder="Enter new password" autocomplete="new-password" required />
                        <button class="btn btn-outline-secondary" type="button" id="togglePassword">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <span asp-validation-for="Password" class="text-danger small"></span>
                    <div class="form-text small text-muted mt-1">
                        <i class="fas fa-info-circle me-1"></i> Minimum 8 characters, including letters and numbers.
                    </div>
                </div>

                <!-- Confirm Password -->
                <div class="mb-4">
                    <label asp-for="ConfirmPassword" class="form-label fw-semibold">Confirm Password</label>
                    <div class="input-group">
                        <input asp-for="ConfirmPassword" type="password" class="form-control form-control-lg" placeholder="Confirm new password" autocomplete="new-password" required />
                        <button class="btn btn-outline-secondary" type="button" id="toggleConfirmPassword">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
                </div>

                <!-- Submit Button -->
                <div class="d-grid mb-4">
                    <button type="submit" class="btn btn-success btn-lg fw-bold shadow-sm">
                        <i class="fas fa-key me-2"></i> Reset Password
                    </button>
                </div>
            </form>

            <!-- Help Section -->
            <div class="text-center">
                <div class="alert alert-light border small mb-3">
                    <i class="fas fa-lock me-1"></i> Your new password will be securely encrypted.
                </div>
                <a href="@Url.Action("Login", "Account")" class="btn btn-link">
                    <i class="fas fa-arrow-left me-1"></i> Back to Login
                </a>
            </div>

            <!-- Security Note -->
            <div class="mt-4 pt-3 border-top text-center small text-muted">
                <i class="fas fa-clock me-1"></i> This reset link is valid for one use only.
            </div>
        </div>
    </div>
</div>


<script>
    // Password visibility toggle
    const toggleVisibility = (btnId, inputName) => {
        const btn = document.getElementById(btnId);
        btn.addEventListener('click', function () {
            const field = document.querySelector(`input[name="${inputName}"]`);
            const icon = this.querySelector('i');
            if (field.type === 'password') {
                field.type = 'text';
                icon.classList.replace('fa-eye', 'fa-eye-slash');
            } else {
                field.type = 'password';
                icon.classList.replace('fa-eye-slash', 'fa-eye');
            }
        });
    };

    toggleVisibility('togglePassword', 'Password');
    toggleVisibility('toggleConfirmPassword', 'ConfirmPassword');
</script>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}